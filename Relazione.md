**Relazione progetto "The Heist" (gruppo: Diamond Inc.)**

**Mannavola Matteo, Sallustio Roberta**

La nostra avventura testuale è stata sviluppata in un'ottica di estendibilità sotto più fronti.

In primo luogo, come previsto nel paradigma Object Oriented, vengono sfruttati meccanismi di ereditarietà tra classi per lasciare spazio ad eventuali future estensioni. Ad esempio, la classe AdvNPC contiene caratteristiche comuni ai personaggi e ai nemici, i quali possiedono ulteriori proprietà aggiunte in estensioni della classe generale. Questa scelta non solo previene la presenza di codice ripetuto, ma consente lo sfruttamento del principio di sostituibilità per fare riferimento a generici NPC.

Inoltre, attraverso l'uso di alcune interfacce e alcune scelte nell'implementazione del Parser, è stato possibile svincolare il gioco dalla lingua in cui vengono scritti gli input dell'utente. Il Parser, infatti, è abbastanza generico e controlla solo che la prima parola sia un comando valido (o un suo alias) e, tra i token successivi, cerca un massimo di 2 altre entità (tra oggetti, oggetti dell'inventario, personaggi e nemici). Altre parole vengono ignorate e la loro eventuale presenza è segnalata in un flag booleano "extraWords". Di conseguenza, gli unici input significativi dell'utente sono i nomi che usa per riferirsi ai comandi e agli oggetti/personaggi/nemici. Tutti questi nomi (e i relativi alias) sono, quindi, stati svincolati dal gioco e inseriti in una specifica implementazione in lingua italiana di un'interfaccia più generica: per far sì che il gioco (i cui output sono comunque in italiano) accetti comandi e nomi di entità in altre lingue, basta realizzare nuove implementazioni delle interfacce e modificare i parametri con cui è istanziato il gioco.

Infine, il progetto contiene due diversi entry point. Uno di questi è un CommandLineEngine, che prende in input una qualsiasi estensione della classe astratta GameDescription e permette di giocare a riga di comando; l'altro è un'interfaccia grafica Swing, specifica del gioco The Heist. A tal fine, per svincolare il gioco da entrambe le soluzioni, il suo metodo principale (nextMove) è stato reso di tipo String: esso aggiorna lo stato del gioco e, infine, restituisce una stringa costruita mediante un oggetto StringBuilder contenente la risposta da far visualizzare all'utente. Quest'ultima viene stampata su console nel caso del CommandLineEngine, mentre viene inserita in una opportuna Text Area nel caso della Swing.

La GUI realizzata con Swing ha diverse caratteristiche in più rispetto alla versione a riga di comando. Sono, infatti, presenti diversi pulsanti per compiere azioni che altrimenti si potrebbero effettuare solo testualmente, e vengono dinamicamente aggiornate diverse informazioni a video, come ad esempio la salute corrente del giocatore, la stanza in cui si trova e gli oggetti presenti nell'inventario. Sono presenti, inoltre, delle funzionalità di salvataggio e caricamento da file, più raffinate nella versione con Swing rispetto alla linea di comando: quest'ultima agisce su un solo file, mentre con Swing è possibile dare un nome al file di salvataggio, scegliere quale caricare e ricominciare una nuova partita. Nella Swing, inoltre, queste operazioni richiedono una conferma da parte dell'utente in caso ci siano dei progressi non salvati. Nella Swing è anche possibile attivare o disattivare una funzionalità per far apparire il testo gradualmente o immediatamente, ed è possibile attivare/disattivare un sottofondo musicale. Vi sono anche delle schermate contenenti informazioni sul gioco e istruzioni sui comandi.

Altre peculiarità dell'avventura sono la presenza di un personaggio con cui parlare e scambiare oggetti, oltre che un sistema di battaglia (relativamente limitato per fare in modo che il focus del gioco resti la risoluzione degli enigmi). A tal fine, il giocatore è stato dotato di un attributo che tiene traccia della sua salute, che potrebbe diminuire in seguito a certi eventi (tra cui attacchi casuali da parte di nemici) ed aumentare con l'uso di specifici oggetti. L'azzeramento della salute comporta la fine del gioco con un messaggio diverso da quello del raggiungimento dell'obiettivo finale.

Un'altra particolarità del gioco è la presenza di diversi flag booleani classificati come "eventi". Questi tengono traccia del flusso della narrazione, e permettono di verificare se certe condizioni sono state soddisfatte; in caso positivo, si possono innescare specifici eventi unici e irripetibili, che permettono al giocatore di progredire nell'avventura.

Riteniamo altrettanto particolare la presenza di oggetti equipaggiabili, che, a differenza di altri oggetti consumabili o privi di particolari caratteristiche, se equipaggiati garantiscono vantaggi nel gioco (necessari al raggiungimento del finale) e, in alcuni casi, permettono di eseguire azioni altrimenti impossibili.
